{% extends 'chart/base.html' %}
{% block title %}Визуализация данных{% endblock %}

{% block content %}
<!-- Основной контент -->
    <div class="main-layout">
      <!-- Боковая панель -->
      <aside class="sidebar">
        <!-- Фиксированные горизонтальные вкладки -->
        <div class="sidebar-header">
          <a href="#" class="tab-item active" data-tab="tab-1">Загрузка данных</a>
          <a href="#" class="tab-item disabled" data-tab="tab-2">Настройки графика</a>
          <a href="#" class="tab-item" data-tab="tab-3">Созданные графики</a>
          <a href="#" class="tab-item" data-tab="tab-4">О приложении</a>
        </div>
        <!-- Прокручиваемая область -->
        <div class="sidebar-content">
          <div class="tab-content active" id="tab-1">
            <div class="upload-section">
              <h2>Загрузка данных</h2>
              <form id="upload-form" action="/upload/" method="POST" enctype="multipart/form-data">
                <div class="form-group upload flex">
                  <label for="file" class="file-label">Выберите файл (CSV или Excel):</label>
                  <input type="file" id="file" name="file" accept=".csv, .xlsx, .xls" class="file-input" required>
                </div>
                <div id="progress-container" style="display: none;">
                  <label for="progress-bar">Загрузка:</label>
                  <progress id="progress-bar" value="0" max="100"></progress>
                </div>
                <button type="submit" class="submit-btn">Загрузить</button>
              </form>

              <button id="delete-file-btn" class="delete-btn" style="display: none;">Удалить файл</button>

              <div id="error-message" class="error-message"></div>
              <div id="data-preview" class="data-preview"></div>
            </div>
          </div>

          <div class="tab-content" id="tab-2">
            <div class="settings-section flex">
              <div class="settings-header">
                <h2>Настройки графика</h2>
              </div>

              <input type="hidden" id="chart-type" value="">

              <!-- Выбор типа графика с карточками -->
              <div class="chart-type-selection">
                <h3>Выберите тип графика:</h3>
                <div class="chart-types">
                  <div class="chart-card" data-type="line">
                    <svg viewBox="0 -1.5 2253 2253" version="1.1" xmlns="http://www.w3.org/2000/svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"
                      xmlns:serif="http://www.serif.com/"
                      style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"
                      fill="#000000">
                      <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                      <g id="SVGRepo_iconCarrier">
                        <rect id="line_chart_parallel" x="1.997" y="0" width="2250" height="2250" style="fill:none;">
                        </rect>
                        <g>
                          <path d="M310.331,408.333l-100,-200l-100,200l200,0Z" style="fill:#202020;"></path>
                          <path d="M1885.33,1983.33l200,100l-200,100l-0,-200Z" style="fill:#202020;"></path>
                          <path d="M210.331,368.333l-0,1715l1715,0"
                            style="fill:none;stroke:#202020;stroke-width:66.67px;"></path>
                        </g>
                        <path d="M418.664,1875l625,-625l208.333,416.667l625,-625"
                          style="fill:none;stroke:#437F97;stroke-width:66.67px;"></path>
                        <path d="M418.664,1583.33l625,-750l208.333,333.334l625,-750"
                          style="fill:none;stroke:#FD151B;stroke-width:66.67px;"></path>
                      </g>
                    </svg>
                    <p>Линейный график</p>
                  </div>
                  <div class="chart-card" data-type="bar">
                    <svg viewBox="0 -1.5 2253 2253" version="1.1" xmlns="http://www.w3.org/2000/svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"
                      xmlns:serif="http://www.serif.com/"
                      style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"
                      fill="#000000">

                      <g id="SVGRepo_bgCarrier" stroke-width="0" />

                      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" />

                      <g id="SVGRepo_iconCarrier">
                        <rect id="stacked_bar_chart" x="1.997" y="0" width="2250" height="2250" style="fill:none;" />
                        <rect x="397.831" y="1187.5" width="312.5" height="666.667"
                          style="fill:#437F97;stroke:#202020;stroke-width:66.67px;" />
                        <rect x="397.831" y="1000" width="312.5" height="187.5"
                          style="fill:#FD151B;stroke:#202020;stroke-width:66.67px;" />
                        <rect x="397.831" y="708.333" width="312.5" height="281.25"
                          style="fill:#eee;stroke:#202020;stroke-width:66.67px;" />
                        <rect x="918.664" y="1437.5" width="312.5" height="416.667"
                          style="fill:#437F97;stroke:#202020;stroke-width:66.67px;" />
                        <rect x="1439.5" y="1229.17" width="312.5" height="625"
                          style="fill:#437F97;stroke:#202020;stroke-width:66.67px;" />
                        <rect x="918.664" y="1312.5" width="312.5" height="125"
                          style="fill:#FD151B;stroke:#202020;stroke-width:66.67px;" />
                        <rect x="1439.5" y="914.583" width="312.5" height="314.583"
                          style="fill:#FD151B;stroke:#202020;stroke-width:66.67px;" />
                        <rect x="918.664" y="1062.5" width="312.5" height="250"
                          style="fill:#eee;stroke:#202020;stroke-width:66.67px;" />
                        <rect x="1439.5" y="395.833" width="312.5" height="518.75"
                          style="fill:#eee;stroke:#202020;stroke-width:66.67px;" />
                        <g>
                          <path d="M289.497,387.5l-100,-200l-100,200l200,-0Z" style="fill:#202020;" />
                          <path d="M1864.5,1962.5l200,100l-200,100l0,-200Z" style="fill:#202020;" />
                          <path d="M189.497,347.5l0,1715l1715,-0"
                            style="fill:none;stroke:#202020;stroke-width:66.67px;" />
                        </g>
                      </g>

                    </svg>
                    <p>Столбчатая диаграмма</p>
                  </div>
                  <div class="chart-card" data-type="pie">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512.001 512.001" xml:space="preserve"
                      fill="#000000">
                      <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                      <g id="SVGRepo_iconCarrier">
                        <circle style="fill:#849324;" cx="257.107" cy="256.104" r="246.892"></circle>
                        <path style="fill:#FD151B;"
                          d="M503.988,256.105H257.109V9.214C393.457,9.214,503.988,119.757,503.988,256.105z"></path>
                        <path style="fill:#437F97;"
                          d="M257.113,9.226v246.879L82.532,430.686c-96.406-96.418-96.406-252.744,0-349.15 C130.747,33.321,193.93,9.226,257.113,9.226z">
                        </path>
                        <path
                          d="M437.126,74.944c-99.836-99.834-262.279-99.836-362.112,0c-15.733,15.732-29.331,33.372-40.416,52.431 c-2.544,4.374-1.061,9.984,3.315,12.529c4.373,2.545,9.983,1.061,12.529-3.314c10.289-17.691,22.917-34.072,37.532-48.686 c44.018-44.018,101.147-67.116,158.931-69.325v233.624l-145.49,145.488c-3.579,3.579-3.579,9.38,0,12.959 c1.79,1.79,4.135,2.684,6.481,2.684c2.345,0,4.691-0.894,6.481-2.684l145.488-145.488h91.213c5.062,0,9.164-4.103,9.164-9.164 s-4.102-9.164-9.164-9.164h-85.846V18.578c57.786,2.209,114.913,25.307,158.931,69.325s67.115,101.147,69.325,158.933H388.954 c-5.062,0-9.164,4.103-9.164,9.164c0,5.061,4.102,9.164,9.164,9.164H493.49c-2.209,57.786-25.307,114.913-69.325,158.933 c-92.688,92.689-243.503,92.689-336.192,0c-32.212-32.212-54.373-72.644-64.087-116.926c-9.46-43.13-6.803-87.92,7.684-129.529 c1.664-4.78-0.861-10.003-5.641-11.668c-4.774-1.664-10.003,0.861-11.668,5.641c-15.603,44.81-18.464,93.042-8.277,139.483 c10.465,47.709,34.336,91.265,69.028,125.958c49.918,49.917,115.488,74.876,181.057,74.876s131.139-24.959,181.057-74.876 C536.959,337.221,536.959,174.779,437.126,74.944z">
                        </path>
                      </g>
                    </svg>
                    <p>Круговая диаграмма</p>
                  </div>
                  <div class="chart-card" data-type="hist">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve"
                      fill="#000000">
                      <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                      <g id="SVGRepo_iconCarrier">
                        <path style="fill:#437F97;"
                          d="M294.9,8.305H217.1c-11.978,0-21.688,9.71-21.688,21.688v452.014c0,11.978,9.71,21.688,21.688,21.688 H294.9c11.978,0,21.688-9.71,21.688-21.688V29.993C316.588,18.015,306.878,8.305,294.9,8.305z">
                        </path>
                        <path style="opacity:0.1;enable-background:new ;"
                          d="M239.705,482.007V29.993c0-11.978,9.71-21.688,21.688-21.688H217.1 c-11.978,0-21.688,9.71-21.688,21.688v452.014c0,11.978,9.71,21.688,21.688,21.688h44.293 C249.415,503.695,239.705,493.985,239.705,482.007z">
                        </path>
                        <path style="fill:#FD151B;"
                          d="M134.522,255.999H56.723c-11.978,0-21.688,9.71-21.688,21.688v204.32 c0,11.978,9.71,21.688,21.688,21.688h77.799c11.978,0,21.688-9.71,21.688-21.688v-204.32 C156.209,265.71,146.5,255.999,134.522,255.999z">
                        </path>
                        <path style="opacity:0.1;enable-background:new ;"
                          d="M79.327,482.007v-204.32c0-11.978,9.71-21.688,21.688-21.688H56.723 c-11.978,0-21.688,9.71-21.688,21.688v204.32c0,11.978,9.71,21.688,21.688,21.688h44.293 C89.038,503.695,79.327,493.985,79.327,482.007z">
                        </path>
                        <path style="fill:#FFB30F;"
                          d="M455.277,165.119h-77.799c-11.978,0-21.688,9.71-21.688,21.688v295.201 c0,11.978,9.71,21.688,21.688,21.688h77.799c11.978,0,21.688-9.71,21.688-21.688V186.807 C476.965,174.829,467.255,165.119,455.277,165.119z">
                        </path>
                        <path style="opacity:0.1;enable-background:new ;"
                          d="M400.084,482.007V186.806c0-11.978,9.71-21.688,21.688-21.688h-44.293 c-11.978,0-21.688,9.71-21.688,21.688v295.201c0,11.978,9.71,21.688,21.688,21.688h44.293 C409.794,503.695,400.084,493.985,400.084,482.007z">
                        </path>
                        <path
                          d="M294.9,512h-77.798c-16.539,0-29.993-13.455-29.993-29.993V102.472c0-4.587,3.717-8.305,8.305-8.305 c4.588,0,8.305,3.718,8.305,8.305v379.536c0,7.379,6.004,13.383,13.383,13.383h77.799c7.379,0,13.382-6.004,13.382-13.383V29.993 c0-7.379-6.003-13.383-13.382-13.383h-77.799c-7.379,0-13.383,6.004-13.383,13.383v39.259c0,4.587-3.717,8.305-8.305,8.305 c-4.588,0-8.305-3.718-8.305-8.305V29.993C187.109,13.455,200.563,0,217.101,0h77.799c16.538,0,29.992,13.455,29.992,29.993v452.014 C324.891,498.545,311.438,512,294.9,512z">
                        </path>
                        <path
                          d="M134.521,512H56.723c-16.539,0-29.993-13.455-29.993-29.993v-134.23c0-4.587,3.717-8.305,8.305-8.305 s8.305,3.718,8.305,8.305v134.23c0,7.379,6.004,13.383,13.383,13.383h77.799c7.379,0,13.383-6.004,13.383-13.383v-204.32 c0-7.379-6.004-13.383-13.383-13.383H56.723c-7.379,0-13.383,6.004-13.383,13.383v36.871c0,4.587-3.717,8.305-8.305,8.305 s-8.305-3.718-8.305-8.305v-36.87c0-16.538,13.454-29.993,29.993-29.993h77.799c16.539,0,29.993,13.455,29.993,29.993v204.32 C164.514,498.545,151.06,512,134.521,512z">
                        </path>
                        <path
                          d="M455.277,512h-77.799c-16.539,0-29.993-13.455-29.993-29.993v-295.2c0-16.538,13.454-29.993,29.993-29.993h77.799 c16.539,0,29.993,13.455,29.993,29.993v195.534c0,4.587-3.717,8.305-8.305,8.305s-8.305-3.718-8.305-8.305V186.807 c0-7.379-6.004-13.383-13.383-13.383h-77.799c-7.379,0-13.383,6.004-13.383,13.383v295.2c0,7.379,6.004,13.383,13.383,13.383h77.799 c7.379,0,13.383-6.004,13.383-13.383V415.56c0-4.587,3.717-8.305,8.305-8.305s8.305,3.718,8.305,8.305v66.447 C485.27,498.545,471.816,512,455.277,512z">
                        </path>
                      </g>
                    </svg>
                    <p>Гистограмма</p>
                  </div>
                </div>
              </div>

              <div id="line-chart-settings" class="chart-settings hidden">
                <!-- Выбор осей X и Y -->
                <div class="form-group choice-x">
                  <label for="line-x-axis">Ось X:</label>
                  <select id="line-x-axis" class="input-select">
                    <!-- Здесь будет список столбцов данных для оси X -->
                  </select>
                </div>
                <div class="form-group choice-y">
                  <label for="line-y-axis">Ось Y:</label>
                  <select id="line-y-axis" class="input-select">
                    <!-- Здесь будет список столбцов данных для оси Y -->
                  </select>
                </div>
                <!-- Настройки цвета -->
                <div class="form-group color">
                  <label for="line-color">Цвет линии:</label>
                  <input type="color" id="line-color" class="input-color" value="#FF5733">
                </div>
                <div class="form-group line-width">
                  <label for="line-width">Толщина линии:</label>
                  <input type="range" id="line-width" min="1" max="10" value="2"
                    oninput="document.getElementById('line-width-value').textContent = this.value">
                  <span id="line-width-value">2</span>
                </div>
                <div class="form-group line-style">
                  <label for="line-style">Тип линии:</label>
                  <select id="line-style" class="input-select">
                    <option value="solid">Сплошная &#8213;</option>
                    <option value="dashed">Пунктирная &#8213; &#8213;</option>
                    <option value="dotted">Точечная &#183;&#183;&#183;</option>
                  </select>
                </div>
                <!-- Настройки заголовков -->
                <div class="form-group title">
                  <label for="line-title">Заголовок графика:</label>
                  <input type="text" id="line-title" class="input-text" placeholder="Введите заголовок">
                </div>
                <div class="form-group title_x">
                  <label for="line-x-axis-label">Подпись оси X:</label>
                  <input type="text" id="line-x-axis-label" class="input-text" placeholder="Введите подпись оси X">
                </div>
                <div class="form-group title_y">
                  <label for="line-y-axis-label">Подпись оси Y:</label>
                  <input type="text" id="line-y-axis-label" class="input-text" placeholder="Введите подпись оси Y">
                </div>
              </div>

              <div id="bar-chart-settings" class="chart-settings hidden">
                <!-- Настройки для столбчатой диаграммы -->
                <div class="form-group choice-x">
                  <label for="bar-x-axis">Ось X:</label>
                  <select id="bar-x-axis" class="input-select">
                    <!-- Здесь будет список столбцов данных для оси X -->
                  </select>
                </div>
                <div class="form-group choice-y">
                  <label for="bar-y-axis">Ось Y:</label>
                  <select id="bar-y-axis" class="input-select">
                    <!-- Здесь будет список столбцов данных для оси Y -->
                  </select>
                </div>
                <div class="form-group color">
                  <label for="bar-color">Цвет столбцов:</label>
                  <input type="color" id="bar-color" class="input-color">
                </div>
                <!-- Настройки заголовков -->
                <div class="form-group title">
                  <label for="bar-title">Заголовок графика:</label>
                  <input type="text" id="bar-title" class="input-text" placeholder="Введите заголовок">
                </div>
                <div class="form-group title_x">
                  <label for="bar-x-axis-label">Подпись оси X:</label>
                  <input type="text" id="bar-x-axis-label" class="input-text" placeholder="Введите подпись оси X">
                </div>
                <div class="form-group title_y">
                  <label for="bar-y-axis-label">Подпись оси Y:</label>
                  <input type="text" id="bar-y-axis-label" class="input-text" placeholder="Введите подпись оси Y">
                </div>
              </div>

              <div id="pie-chart-settings" class="chart-settings hidden">
                <!-- Настройки для круговой диаграммы -->
                <div class="form-group choice-category">
                  <label for="pie-x-axis">Категории:</label>
                  <select id="pie-x-axis" class="input-select">
                    <!-- Здесь будет список столбцов данных для категорий -->
                  </select>
                </div>
                <div class="form-group choice-value">
                  <label for="pie-y-axis">Значения:</label>
                  <select id="pie-y-axis" class="input-select">
                    <!-- Здесь будет список столбцов данных для значений -->
                  </select>
                </div>
                <div class="form-group color">
                  <label for="pie-custom-colors">Пользовательские цвета:</label>
                  <div id="pie-custom-colors" class="color-palette flex">
                    <div class="pie-color-buttons flex">
                      <button type="button" id="add-color" class="submit-btn add-color-btn">Добавить цвет</button>
                      <button type="button" id="delete-color" class="delete-btn del-color-btn">Удалить цвет</button>
                    </div>
                  </div>
                </div>
                <!-- Настройки заголовков -->
                <div class="form-group title">
                  <label for="pie-title">Заголовок графика:</label>
                  <input type="text" id="pie-title" class="input-text" placeholder="Введите заголовок">
                </div>
              </div>

              <div id="hist-chart-settings" class="chart-settings hidden">
                <!-- Настройки для гистограммы -->
                <div class="form-group choice-x">
                  <label for="hist-x-axis">Ось X:</label>
                  <select id="hist-x-axis" class="input-select">
                    <!-- Здесь будет список столбцов данных для оси X -->
                  </select>
                </div>
                <div class="form-group bins">
                  <label for="hist-bins">Количество корзин:</label>
                  <input type="number" id="hist-bins" class="input-number" min="1" max="50" value="10">
                </div>
                <div class="form-group color">
                  <label for="hist-color">Цвет столбцов:</label>
                  <input type="color" id="hist-color" class="input-color" value="#2ECC71">
                </div>
                <!-- Настройки заголовков -->
                <div class="form-group title">
                  <label for="hist-title">Заголовок графика:</label>
                  <input type="text" id="hist-title" class="input-text" placeholder="Введите заголовок">
                </div>
                <div class="form-group title_x">
                  <label for="hist-x-axis-label">Подпись оси X:</label>
                  <input type="text" id="hist-x-axis-label" class="input-text" placeholder="Введите подпись оси X">
                </div>
              </div>

              <!-- Кнопка для дополнительных настроек -->
              <!--<button id="toggle-advanced-settings-btn" class="submit-btn advanced-settings-btn flex">
                <span>Дополнительные настройки</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
                </svg>
              </button>-->

              <!-- Секция дополнительных настроек -->
              <!--<div id="advanced-settings" class="advanced-settings hidden">
                <div class="form-group font-family">
                  <label for="chart-font-family">Шрифт:</label>
                  <select id="chart-font-family" class="input-select">
                    <option value="Arial">Arial</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Tahoma">Tahoma</option>
                    <option value="Times New Roman">Times New Roman</option>
                  </select>
                </div>
                <div class="form-group font-color">
                  <label for="chart-font-color">Цвет шрифта:</label>
                  <input type="color" id="chart-font-color" class="input-color" value="#000000">
                </div>
                <div class="form-group grid-display">
                  <label>
                    <input type="checkbox" id="chart-show-grid" checked>
                    Отображение сетки
                  </label>
                </div>
                <div class="form-group legend-display">
                  <label>
                    <input type="checkbox" id="chart-show-legend" checked>
                    Отображение легенды
                  </label>
                </div>
                <div class="form-group legend-position">
                  <label for="chart-legend-position">Положение легенды:</label>
                  <select id="chart-legend-position" class="input-select">
                    <option value="top">Сверху</option>
                    <option value="bottom">Снизу</option>
                    <option value="left">Слева</option>
                    <option value="right">Справа</option>
                  </select>
                </div>
              </div>-->

              <!-- Кнопка для создания графика -->
              <button id="create-chart-btn" class="submit-btn">Создать график</button>
            </div>
          </div>

          <div class="tab-content" id="tab-3">
            <h2>Мои сохранённые графики</h2>
            <div id="savedChartsContainer">
              <!-- сюда JS подгрузит список -->
            </div>
          </div>

          <div class="tab-content" id="tab-4">
            <div class="about-section">
              <h2>О приложении ChartHaven</h2>
              <p><strong>ChartHaven</strong> — это современное веб-приложение для визуализации и анализа ваших данных без необходимости программирования.</p>
              <ul>
                <li>Загружайте CSV или Excel-файлы</li>
                <li>Стройте линейные, столбчатые, круговые диаграммы и гистограммы</li>
                <li>Гибко настраивайте внешний вид графиков</li>
                <li>Сохраняйте и скачивайте свои визуализации</li>
                <li>Работает на всех устройствах: ПК, планшетах и смартфонах</li>
              </ul>
              <p>Исходный код: <a href="https://github.com/your-org/charthaven" target="_blank">github.com/your-org/charthaven</a></p>
              <p>Обратная связь: <a href="mailto:support@charthaven.com">support@charthaven.com</a></p>
            </div>
          </div>
        </div>
      </aside>
      <div class="sidebar-overlay" id="sidebarOverlay"></div>

      <!-- Центральный блок -->
      <main class="content-area">
        <!-- Центральная шапка -->
        <section class="content-header flex">
          <h1 id="chart-title-header"></h1>
          <div class="scale-download-container flex">
            <!-- <div class="scale flex">
              <a class="minus flex" href="#">
                <svg viewBox="0 0 17 2" xmlns="http://www.w3.org/2000/svg">
                  <path d="M1 1H16" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </a>
              <p class="scale-text flex">100%</p>
              <a class="plus" href="#">
                <svg viewBox="0 0 17 17" xmlns="http://www.w3.org/2000/svg">
                  <path d="M1 8.5H16M8.5 1V16" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </a>
            </div> -->
            <a class="download flex" href="#">
              <svg class="download-btn" viewBox="0 0 55 42" xmlns="http://www.w3.org/2000/svg">
                <rect width="54.5" height="41.75" rx="10" />
                <path d="M20 31.75H34.5M27.25 10V26.9167M27.25 26.9167L33.2917 20.875M27.25 26.9167L21.2083 20.875"
                  stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </a>
          </div>
        </section>


        <!-- Контент -->
        <section class="content">
          <!-- Контейнер для отображения графика -->
          <div id="chart-container"></div>
        </section>
      </main>
    </div>
{% endblock %}



